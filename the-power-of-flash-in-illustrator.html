<!doctypehtml><html lang=en><meta content="Julien Barbay"name=author><meta content=@y_nk name=twitter:creator><meta content=summary name=twitter:card><meta charset=utf-8><meta content="IE=edge"http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1"name=viewport><title>y_nk – The power of Flash in Illustrator… at most!</title><link href=./style.css rel=stylesheet><link href=./favicon.svg rel=icon type=image/svg+xml><link href=//cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.0.0/build/styles/paraiso-dark.min.css rel=stylesheet><script src=//cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.0.0/build/highlight.min.js></script><script>hljs.initHighlightingOnLoad()</script><meta content=article property=og:type><meta content="Julien Barbay"property=article:author><meta content="The power of Flash in Illustrator… at most!"property=og:title><meta content="Tips around using Adobe PatchPanel to enhance Illustrator CS3 authoring experience"property=description><meta content="Tips around using Adobe PatchPanel to enhance Illustrator CS3 authoring experience"property=og:description><meta content=././the-power-of-flash-in-illustrator.html property=og:url><meta content=1349276400000 property=article:published_time><body class=post><header><h1><a href=./ ><svg id=y_nk viewBox="0 0 100 65"><polygon class=bk points="10.1,0 20.3,10.1 0,10.1"></polygon><polygon class=ft points="20.3,10.1 46.2,36.1 36.1,46.2 0,10.1"></polygon><polygon class=bk points="35.6,10.1 45.8,20.3 45.8,0"></polygon><polygon class=ft points="89.9,44.3 89.9,64.6 45.8,20.3 45.8,0"></polygon><polygon class=bk points="89.9,0 79.7,10.1 100,10.1"></polygon><polygon class=ft points="79.7,10.1 75.3,14.6 85.4,24.7 100,10.1"></polygon><polygon class=bk points="100,54.4 89.9,44.3 89.9,64.6"></polygon></svg></a></h1></header><section id=main><hgroup><h2>The power of Flash in Illustrator… at most!</h2><h6>October 4th, 2012</h6></hgroup><article><p><disclaimer>The original article has been retrieved from the internet archive machine and edited for fluidity.</disclaimer><p>Experienced designers probably already know that you can script Illustrator with ExtendedScriptToolKit (ESKT) and Javascript, thanks to a DOM tree-ish structure created by Adobe. That said, since Adobe CS3 we can also see some cool richs panels (such as Kuler) made in Flash too.<p>Patchpanel is a tool created by Adobe to use AS3 to create panels for the Create Suite 3 and 4. It's still a beta, approaching slowly a v0.8. Similar to <a href=http://labs.adobe.com/wiki/index.php/SwitchBoard>SwitchBoard</a>, it consists of a SWC library with a bunch of objects we can use to interact with the host application (Illustrator, but not only).<p>There are 4 versions of this library: one for each version of CS (3 & 4), but also one per OS (Win & Mac). It's honestly quite confusing but hopefully the way you use the code is similar accross all 4.<p>It's a super cool tech. I think for digital agencies willing to invest time, you can definitely create tooling which fits your team, so there will never be a "I wished I could do this in Illustrator but I can't" anymore.<p>I thought this would be the perfect tool to help my current team. It's really common that UX designers would work on the same big illustrator sitemap separately, and then book a day long meeting to merge their work later on. I thought that, with PatchPanel, I could bring collaborative editing into Illustrator, saving them time.<p>I first drafted the concept of having a small <a href=http://osflash.org/red5>red5 server</a> and some <a href=http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/net/SharedObject.html>SharedObjects</a>, and replicate the 2 DOMs of the documents. They'd be 2 files, but linked through a server. Sadly, after some research on PatchPanel, I found that I couldn't really listen to user events related to selecting/deselecting an object.<p>Instead I've decided to downgrade the scope of my project to a simple chat application where users could also have a "transmit" button to send a shape over the network. A bit like a network-capable copy/paste :)<h3 id=find-the-selection>Find the selection</h3><p>It was probably the most painful part. The documentation says to use:<pre><code>Illustrator.app.selection:Object;
Illustrator.app.activeDocument.selection:Object;</code></pre><p>I've dug deeper into Adobe's website until I found <a href=http://www.adobe.com/devnet/illustrator/pdfs/illustrator_scripting_reference_javascript.pdf>Illustrator's JS scripting documentation</a> ; the kind of document you <em>really</em> need when working with PatchPanel, since somehow PP is just a bridge back to this technology.<p>The JS documentation is <em>slighlty</em> more precise:<pre><code>Illustrator.app.selection:Object > Array of Object;
Illustrator.app.activeDocument.selection:Array > Array of Object;</code></pre><p>After few calls to <code>describeType</code>, I went for the bare minimum:<pre><code>&lt;?xml version="1.0" encoding="utf-8"?>
&lt;mx:Application xmlns:mx="http://www.adobe.com/2006/mxml">
  &lt;mx:Script>
  &lt;![CDATA[
  import com.adobe.cs3.Illustrator.*;
  //import com.adobe.cs4.Illustrator.*;

  private function click():void {
    csl.text += "active doc selection : " + Illustrator.app.activeDocument.selection + "\n";
    csl.text += "illustrator selection : " + Illustrator.app.selection + "\n";
  }
  ]]>
  &lt;/mx:Script>

  &lt;mx:TextArea width="100%" height="100%" id="csl" />
  &lt;mx:HBox width="100%">
    &lt;mx:Spacer width="100%" />
    &lt;mx:LinkButton label="trace" click="click()" />
  &lt;/mx:HBox>
&lt;/mx:Application></code></pre><p>I searched for days until I almost gave up. I went to Adobe's forum about PatchPanel to report my issue, which stayed unanswered for some days. About a week after, a guy named "Bernd Paradies" – whom I assume worked in the PP team – answered that what I reported was not an issue, rather an undiscovered bug (and that he'd found others related to it).<p>So I've been instructed into a workaround which I wouldn't have been able to pull myself. I'm pretty novice with working with namespaces so it wasn't so natural to me, although it was quite simple.<pre><code>import com.adobe.PatchPanel.patchpanel_internal;

private function getSelection(obj: IllustratorHostObject): Array {
    // enables the access to PatchPanel's hidden HostObject functions like $get()
    use namespace patchpanel_internal;

    // The following line tells PatchPanel's glue code to return an Array (not an Object).
    return obj.$get("selection", Array);
}</code></pre><p>I only reshaped the function and made it a static getter function in some utilitary class, but you get the gist.<h3 id=cloning-an-object>Cloning an object</h3><p>Visual object in an Illustrator document list :<ul><li><strong>PageItem</strong>: a kindof abstract object, root of all of others<li><strong>PathItem</strong>: a simple path with the path tool<li><strong>CompoundPathItem</strong>: an object gathering many paths (an array of paths?)<li><strong>MeshItem</strong>: a gradient<li><strong>TextFrame</strong>: a text block<li><strong>GroupItem</strong>: an abstract group of object (that cmd+g in Illustrator)<li><strong>RasterItem</strong>: a rasterized view of an object<li><strong>PluginItem</strong>: not really sure yet. Probably a vectorized drawing made with Livetrace.</ul><p>The doc has the following:<pre><code>toSource():String > a script to reproduce the object</code></pre><p>Aweso... well not really. Whenever I call it, it always returns <code>({})</code>; but <code>.toString()</code> works!<p>I didn't push through trying with the namespaces available, but i do hope it helps (i'll dig that later, probably)<p>I've been abusing <code>.toString()</code> to collect all meaningful properties for each of the objects with the goal to implement my own cloning function and it was... long.<h3 id=as-for-today>As for today</h3><p>This is it. I'll probably write a second article to follow up on the end of the project. Once the cloning has been made, it should be quite easy to reproduce at least simple shapes/text. Sending them over the network is a piece of cake, so I'm not worried for the future.<p>PatchPanel is quite interesting and offers a lot of possibilities, but I honestly think Adobe did not really put a lot of thoughts into it, and rather made "the fastest AS&lt;->JS bridge" possible rather than a full rewrite which would have enabled more power to us, consumers. As it's a very early beta, let's hope for the future.</article></section><footer><a href=./ class=!>← back</a></footer><script>const colors=["blue","cornflowerblue","darkorange","darkturquoise","deepskyblue","dodgerblue","gold","goldenrod","indigo","lightcoral","lightgreen","lightpink","lightseagreen","lightskyblue","lightslategray","limegreen","mediumaquamarine","mediumblue","mediumspringgreen","midnightblue","moccasin","navajowhite","orange","orangered","palegreen","paleturquoise","pink","rebeccapurple","royalblue","salmon","sandybrown","seagreen","skyblue","springgreen","steelblue","teal","tomato"];document.body.style.setProperty("--accent",colors[Math.floor(Math.random()*colors.length)])</script>