<!DOCTYPE html><html lang="en"><head>
    <meta name="author" content="Julien Barbay">
    <meta name="twitter:creator" content="@y_nk">
    <meta name="twitter:card" content="summary">

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>y_nk – The power of Flash in Illustrator… at most!</title>

    <link rel="stylesheet" type="text/css" href="./style.css">
    <link rel="icon" type="image/svg+xml" href="./favicon.svg">
    <link rel="alternate" type="application/rss+xml" href="./feed.xml">

    <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.0.0/build/styles/paraiso-dark.min.css">
    <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.0.0/build/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  <meta property="og:type" content="article"><meta property="article:author" content="Julien Barbay"><meta property="og:title" content="The power of Flash in Illustrator… at most!"><meta property="description" content="Tips around using Adobe PatchPanel to enhance Illustrator CS3 authoring experience"><meta property="og:description" content="Tips around using Adobe PatchPanel to enhance Illustrator CS3 authoring experience"><meta property="og:url" content="/the-power-of-flash-in-illustrator.html"><meta property="article:published_time" content="1349276400000"></head>

  <body class="post">
    <header>
      <h1><a href="./">
        <svg id="y_nk" viewBox="0 0 100 65">
          <polygon class="bk" points="10.1,0 20.3,10.1 0,10.1"></polygon>
          <polygon class="ft" points="20.3,10.1 46.2,36.1 36.1,46.2 0,10.1"></polygon>
          <polygon class="bk" points="35.6,10.1 45.8,20.3 45.8,0"></polygon>
          <polygon class="ft" points="89.9,44.3 89.9,64.6 45.8,20.3 45.8,0"></polygon>
          <polygon class="bk" points="89.9,0 79.7,10.1 100,10.1"></polygon>
          <polygon class="ft" points="79.7,10.1 75.3,14.6 85.4,24.7 100,10.1"></polygon>
          <polygon class="bk" points="100,54.4 89.9,44.3 89.9,64.6"></polygon>
        </svg>
      </a></h1>
    </header>

    <section id="main">
  <hgroup>
    <h2>The power of Flash in Illustrator… at most!</h2>
    <h6>October 3rd, 2012</h6>
  </hgroup>
 <article>
    <p><disclaimer>The original article has been retrieved from the internet archive machine and edited for fluidity.</disclaimer></p>
<p>Experienced designers probably already know that you can script Illustrator with ExtendedScriptToolKit (ESKT) and Javascript, thanks to a DOM tree-ish structure created by Adobe. That said, since Adobe CS3 we can also see some cool richs panels (such as Kuler) made in Flash too.</p>
<p>Patchpanel is a tool created by Adobe to use AS3 to create panels for the Create Suite 3 and 4. It's still a beta, approaching slowly a v0.8. Similar to <a href="http://labs.adobe.com/wiki/index.php/SwitchBoard">SwitchBoard</a>, it consists of a SWC library with a bunch of objects we can use to interact with the host application (Illustrator, but not only).</p>
<p>There are 4 versions of this library: one for each version of CS (3 &amp; 4), but also one per OS (Win &amp; Mac). It's honestly quite confusing but hopefully the way you use the code is similar accross all 4.</p>
<p>It's a super cool tech. I think for digital agencies willing to invest time, you can definitely create tooling which fits your team, so there will never be a "I wished I could do this in Illustrator but I can't" anymore.</p>
<p>I thought this would be the perfect tool to help my current team. It's really common that UX designers would work on the same big illustrator sitemap separately, and then book a day long meeting to merge their work later on. I thought that, with PatchPanel, I could bring collaborative editing into Illustrator, saving them time.</p>
<p>I first drafted the concept of having a small <a href="http://osflash.org/red5">red5 server</a> and some <a href="http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/net/SharedObject.html">SharedObjects</a>, 
and replicate the 2 DOMs of the documents. They'd be 2 files, but linked through a server. Sadly, after some research on PatchPanel, I found that I couldn't really listen to user events related to selecting/deselecting an object.</p>
<p>Instead I've decided to downgrade the scope of my project to a simple chat application where users could also have a "transmit" button to send a shape over the network. A bit like a network-capable copy/paste :)</p>
<h3 id="find-the-selection">Find the selection</h3>
<p>It was probably the most painful part. The documentation says to use:</p>
<pre><code>Illustrator.app.selection:Object;
Illustrator.app.activeDocument.selection:Object;</code></pre>
<p>I've dug deeper into Adobe's website until I found <a href="http://www.adobe.com/devnet/illustrator/pdfs/illustrator_scripting_reference_javascript.pdf">Illustrator's JS scripting documentation</a> ; the kind of document you <em>really</em> need when working with PatchPanel, since somehow PP is just a bridge back to this technology.</p>
<p>The JS documentation is <em>slighlty</em> more precise:</p>
<pre><code>Illustrator.app.selection:Object &gt; Array of Object;
Illustrator.app.activeDocument.selection:Array &gt; Array of Object;</code></pre>
<p>After few calls to <code>describeType</code>, I went for the bare minimum:</p>
<pre><code>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;mx:Application xmlns:mx="http://www.adobe.com/2006/mxml"&gt;
  &lt;mx:Script&gt;
  &lt;![CDATA[
  import com.adobe.cs3.Illustrator.*;
  //import com.adobe.cs4.Illustrator.*;

  private function click():void {
    csl.text += "active doc selection : " + Illustrator.app.activeDocument.selection + "\n";
    csl.text += "illustrator selection : " + Illustrator.app.selection + "\n";
  }
  ]]&gt;
  &lt;/mx:Script&gt;

  &lt;mx:TextArea width="100%" height="100%" id="csl" /&gt;
  &lt;mx:HBox width="100%"&gt;
    &lt;mx:Spacer width="100%" /&gt;
    &lt;mx:LinkButton label="trace" click="click()" /&gt;
  &lt;/mx:HBox&gt;
&lt;/mx:Application&gt;</code></pre>
<p>I searched for days until I almost gave up. I went to Adobe's forum about PatchPanel to report my issue, which stayed unanswered for some days. About a week after, a guy named "Bernd Paradies" – whom I assume worked in the PP team – answered that what I reported was not an issue, rather an undiscovered bug (and that he'd found others related to it).</p>
<p>So I've been instructed into a workaround which I wouldn't have been able to pull myself. I'm pretty novice with working with namespaces so it wasn't so natural to me, although it was quite simple.</p>
<pre><code>import com.adobe.PatchPanel.patchpanel_internal;

private function getSelection(obj: IllustratorHostObject): Array {
    // enables the access to PatchPanel's hidden HostObject functions like $get()
    use namespace patchpanel_internal;

    // The following line tells PatchPanel's glue code to return an Array (not an Object).
    return obj.$get("selection", Array);
}</code></pre>
<p>I only reshaped the function and made it a static getter function in some utilitary class, but you get the gist.</p>
<h3 id="cloning-an-object">Cloning an object</h3>
<p>Visual object in an Illustrator document list :</p>
<ul>
<li><strong>PageItem</strong>: a kindof abstract object, root of all of others</li>
<li><strong>PathItem</strong>: a simple path with the path tool</li>
<li><strong>CompoundPathItem</strong>: an object gathering many paths (an array of paths?)</li>
<li><strong>MeshItem</strong>: a gradient</li>
<li><strong>TextFrame</strong>: a text block</li>
<li><strong>GroupItem</strong>: an abstract group of object (that cmd+g in Illustrator)</li>
<li><strong>RasterItem</strong>: a rasterized view of an object</li>
<li><strong>PluginItem</strong>: not really sure yet. Probably a vectorized drawing made with Livetrace.</li>
</ul>
<p>The doc has the following:</p>
<pre><code>toSource():String &gt; a script to reproduce the object</code></pre>
<p>Aweso... well not really. Whenever I call it, it always returns <code>({})</code>; but <code>.toString()</code> works!</p>
<p>I didn't push through trying with the namespaces available, but i do hope it helps (i'll dig that later, probably)</p>
<p>I've been abusing <code>.toString()</code> to collect all meaningful properties for each of the objects with the goal to implement my own cloning function and it was... long.</p>
<h3 id="as-for-today">As for today</h3>
<p>This is it. I'll probably write a second article to follow up on the end of the project. Once the cloning has been made, it should be quite easy to reproduce at least simple shapes/text. Sending them over the network is a piece of cake, so I'm not worried for the future.</p>
<p>PatchPanel is quite interesting and offers a lot of possibilities, but I honestly think Adobe did not really put a lot of thoughts into it, and rather made "the fastest AS&lt;-&gt;JS bridge" possible rather than a full rewrite which would have enabled more power to us, consumers. As it's a very early beta, let's hope for the future.</p>

  </article></section>

    <footer>
      <a href="./" class="!">← back</a>
    </footer>

    <script>
      const colors = ['blue', 'cornflowerblue', 'darkorange', 'darkturquoise', 'deepskyblue', 'dodgerblue',
        'gold', 'goldenrod', 'indigo', 'lightcoral', 'lightgreen', 'lightpink', 'lightseagreen', 'lightskyblue',
        'lightslategray', 'limegreen', 'mediumaquamarine', 'mediumblue', 'mediumspringgreen', 'midnightblue',
        'moccasin', 'navajowhite', 'orange', 'orangered', 'palegreen', 'paleturquoise', 'pink', 'rebeccapurple',
        'royalblue', 'salmon', 'sandybrown', 'seagreen', 'skyblue', 'springgreen', 'steelblue', 'teal', 'tomato']

      document.body.style.setProperty('--accent', colors[Math.floor(Math.random() * colors.length)])
    </script>
  

</body></html>